# "SkyWars" battle webgame

## Краткое описание
Маленькая игра с веб-интерфейсом о битве героев в стиле олдскульных браузерных игр.

## Технологии
- Flask==2.0
- marshmallow==3.14
- marshmallow-dataclass==8.5

## Как работает проект

1. При переходе на основную страничку с игрой пользователь видит название и кнопку «Начать игру»
2. При нажатии кнопки «Начать игру» пользователь переходит на страницу "Выбор героя".
3. После отправки данных появляется аналогичная форма для выбора параметров противника 
4. После того как основные параметры выбраны, начинается битва.
5. Мы видим данные о герое (слева) и данные о противнике (справа). В центре доступные опции. Внизу результат последнего хода.

## Механика боя

- Бой состоит из ходов. В течение 1 хода игрок может нанести удар, воспользоваться умением или пропустить ход.
- Каждый новый ход выносливости игроков увеличивается на N ед. (Не может превышать максимальное значение.)
- Бой происходит с компьютерным противником. После действия игрока компьютер отвечает. 
- Как игрок, так и компьютер могут использовать умение только один раз за бой.
- Когда компьютер выполняет ответное действие, он имеет 10%-ный шанс воспользоваться умением. Если шанс срабатывает, а умение уже было применено, то компьютер наносит обычный удар.
- Битва окончена, если у одного из персонажей очки здоровья меньше нуля.

### Кнопка «Нанести удар»
При нажатии на кнопку происходит проверка, достаточно ли у персонажа выносливости, чтобы нанести удар. 
Если выносливости недостаточно, пропускаем ход. Если достаточно, тогда переходим к расчету количества урона.
Урон рассчитывается следующим образом:
`УРОН = УРОН_АТАКУЮЩЕГО - БРОНЯ_ЦЕЛИ`

Формула для расчета значения БРОНЯ_ЦЕЛИ: 
`урон_от_оружия = случайное число в диапазоне (min_damage - max_damage)`
`УРОН_АТАКУЮЩЕГО = урон_от_оружия * модификатор_атаки_класса`

Далее перед тем, как рассчитать броню цели, необходимо провести проверку на выносливость. 
Если у персонажа, которого атакуют, достаточно очков выносливости для использования своей брони, 
тогда рассчитываем показатель брони цели следующим образом:
`БРОНЯ_ЦЕЛИ = надетая_броня * модификатор_брони_класса`

Если у персонажа, которого атакуют, очков выносливости для использования своей брони недостаточно, тогда его броня игнорируется.
После того как все расчеты произведены, вычитаем из очков здоровья цели показатель рассчитанного урона.

### Как рассчитывается выносливость в бою
В каждом бою у нас будет задана константа, сколько очков выносливости персонаж восстанавливает за ход.
Расчет выносливости:
- У атакующего вычитаем количество затраченной выносливости на удар.
- У защищающегося вычитаем количество затраченной выносливости за защиту.

### Восстанавливаем выносливость атакующего и защищающего:
- Прибавляем к очкам выносливости атакующего константу, умноженную на модификатор выносливости атакующего.
- Прибавляем к очкам выносливости цели константу, умноженную на модификатор выносливости цели.
- После того как все расчеты произведены, компьютерный противник наносит ответный удар.

### Кнопка «Использовать умение»
- При использовании умения происходит проверка, достаточно ли выносливости у персонажа, использующего умение. 
- Если проверка пройдена успешно, тогда вычитаем очки здоровья цели в соответствии с примененным умением.
- Все остальные проверки игнорируются.
- 
### Кнопка «Пропустить ход»
- Игрок пропускает ход. 
- После чего компьютерный противник совершает действие.

### Кнопка «Завершить бой»
- Переходим на страницу с кнопкой «Начать игру» и начинаем всё сначала.

### Блок логов
- В блоке логов содержится информация о действиях персонажей.
- В логе сначала отображается действия игрока (удар или умение), потом отображается действие противника (удар или умение).

## Структура проекта
- [app.py](app.py) - основной файл для запуска программы
- [config.py](config.py) - файл конфигурации
- [equipment.json](data%2Fequipment.json) - данные по оружию и броне
- [templates](templates) - шаблоны для рендеринга ендпоинтов
- [utils.py](utils.py) - вспомогательные утилиты
- [basesingleton.py](models%2Fbase%2Fbasesingleton.py) - базовый класс синглтон
- [arena.py](models%2Farena.py) - класс наследник от базового класса синглтона
- [unitclass.py](models%2Fbase%2Funitclass.py) - класс описание типов юнитов
- [unitclasses.py](models%2Funitclasses.py) - конкретные типы юнитов
- [baseunit.py](models%2Fbase%2Fbaseunit.py) - абстрактный класс игроков
- [units.py](models%2Funits.py) - реализация героя и противника на основе абстрактного класса
- [armor.py](models%2Fbase%2Farmor.py) - датакласс Броня
- [skill.py](models%2Fbase%2Fskill.py) - абстрактный класс Умение
- [skills.py](models%2Fskills.py) - реализация конкретных умений
- [weapon.py](models%2Fbase%2Fweapon.py) - датакласс Оружие
- [equipment.py](models%2Fequipment.py) - класс Экипировка

## Запуск проекта:
python app.py